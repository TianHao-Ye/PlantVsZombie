window.__require=function t(e,o,n){function a(i,c){if(!o[i]){if(!e[i]){var s=i.split("/");if(s=s[s.length-1],!e[s]){var p="function"==typeof __require&&__require;if(!c&&p)return p(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+i+"'")}i=s}var u=o[i]={exports:{}};e[i][0].call(u.exports,function(t){return a(e[i][1][t]||t)},u,u.exports,t,e,o,n)}return o[i].exports}for(var r="function"==typeof __require&&__require,i=0;i<n.length;i++)a(n[i]);return a}({DragManager:[function(t,e,o){"use strict";cc._RF.push(e,"5dd63bIE+NEAZGCr3eB+4r9","DragManager");var n=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,i=(a.property,function(){function t(){this._dragLayer=void 0,this._gameManager=void 0,this._draggingCard=void 0}return t.prototype.init=function(t,e){this._dragLayer=t,this._gameManager=e},t.prototype.onGlobalTouchStart=function(t){for(var e=0,o=this._gameManager.getUiManager().plantCardContainer.children;e<o.length;e++){var n=o[e];if(n.getBoundingBoxToWorld().contains(t))return this._startDragging(n),!0}return!1},t.prototype.onGlobalTouchMove=function(t){if(this._draggingCard){var e=this._dragLayer.convertToNodeSpaceAR(t);this._draggingCard.setPosition(e)}},t.prototype.onGlobalTouchEnd=function(t){if(this._draggingCard){var e=this._dragLayer.convertToNodeSpaceAR(t),o=this._gameManager.getGridManager().worldPosToGrid(e);o&&this._gameManager.getPlantManager().plantOnLayer(o,this._draggingCard),this._draggingCard.destroy(),this._draggingCard=void 0}},t.prototype._startDragging=function(t){var e=cc.instantiate(t),o=t.convertToWorldSpaceAR(cc.Vec2.ZERO),n=this._dragLayer.convertToNodeSpaceAR(o);this._dragLayer.addChild(e),e.setPosition(n),e.opacity=100,this._draggingCard=e},n([r],t)}());o.default=i,cc._RF.pop()},{}],Entity:[function(t,e,o){"use strict";cc._RF.push(e,"c1ac4vX0fZFS7YTtLe96k3G","Entity");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,c=i.ccclass,s=i.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.health=100,e.damage=10,e.attackInterval=1.5,e}return a(e,t),e.prototype.takeDamage=function(t){return this.health-=t,!(this.health<=0&&(this.die(),1))},e.prototype.attack=function(){},e.prototype.die=function(){cc.Tween.stopAllByTarget(this.node),this.node.destroy()},e.prototype.getHealth=function(){return this.health},e.prototype.getDamage=function(){return this.damage},e.prototype.getAttackInterval=function(){return this.attackInterval},r([s],e.prototype,"health",void 0),r([s],e.prototype,"damage",void 0),r([s],e.prototype,"attackInterval",void 0),r([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"aa51bD+kaFJ04NHerCKeliC","GameManager");var n=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Functional/GameScheduler"),r=t("../Functional/TouchEventManager"),i=t("./DragManager"),c=t("./GridManager"),s=t("./PlantCardManager"),p=t("./PlantManager"),u=t("./ShovelManager"),l=t("./SunManager"),h=t("./UIManager"),d=t("./WeaponManager"),f=t("./ZombieManager"),g=cc._decorator,_=g.ccclass,y=(g.property,function(){function t(){this._plantManager=void 0,this._gridManager=void 0,this._plantCardManager=void 0,this._dragManager=void 0,this._shovelManager=void 0,this._sunManager=void 0,this._uiManager=void 0,this._gameScheduler=void 0,this._touchEventManager=void 0,this._weaponManager=void 0,this._zombieManager=void 0}var e;return e=t,t.getInstance=function(){return this._instance||(this._instance=new e),this._instance},t.prototype.init=function(t,e,o,n,g,_,y,v,M,m,b,S,P,w,O,C,R,G,j,L,T,E,F,k,N){this._plantManager=new p.default,this._gridManager=new c.default,this._plantCardManager=new s.default,this._dragManager=new i.default,this._shovelManager=new u.default,this._sunManager=new l.default,this._uiManager=new h.default,this._gameScheduler=_.getComponent(a.default),this._touchEventManager=new r.default,this._weaponManager=new d.default,this._zombieManager=new f.default,this._uiManager.init(L,T,E,F,k,N,this,this._shovelManager.toggleShovelMode.bind(this._shovelManager)),this._plantManager.init(e,M,this),this._gridManager.init(w,O,C,R,G,j,this),this._plantCardManager.init(m,this),this._dragManager.init(n,this),this._shovelManager.init(o,this),this._sunManager.init(g,b,this),this._touchEventManager.init(y,this),this._weaponManager.init(v,S,this),this._zombieManager.init(t,P,this)},t.prototype.playGame=function(){this._uiManager.playGame(),this._plantCardManager.playGame(),this._sunManager.playGame(),this._touchEventManager.playGame(),this._zombieManager.playGame()},t.prototype.endGame=function(){this._uiManager.endGame(),this._gameScheduler.stopAll(),this._sunManager.endGame(),this._zombieManager.endGame(),this._plantManager.endGame(),this._gridManager.endGame(),this._shovelManager.endGame(),this._touchEventManager.endGame()},t.prototype.update=function(t){this._zombieManager.update(t)},t.prototype.getPlantCardManager=function(){return this._plantCardManager},t.prototype.getGridManager=function(){return this._gridManager},t.prototype.getPlantManager=function(){return this._plantManager},t.prototype.getDragManager=function(){return this._dragManager},t.prototype.getShovelManager=function(){return this._shovelManager},t.prototype.getUiManager=function(){return this._uiManager},t.prototype.getSunManager=function(){return this._sunManager},t.prototype.getGameScheduler=function(){return this._gameScheduler},t.prototype.getTouchEventManager=function(){return this._touchEventManager},t.prototype.getWeaponManager=function(){return this._weaponManager},t.prototype.getZombieManager=function(){return this._zombieManager},t._instance=void 0,e=n([_],t)}());o.default=y,cc._RF.pop()},{"../Functional/GameScheduler":"GameScheduler","../Functional/TouchEventManager":"TouchEventManager","./DragManager":"DragManager","./GridManager":"GridManager","./PlantCardManager":"PlantCardManager","./PlantManager":"PlantManager","./ShovelManager":"ShovelManager","./SunManager":"SunManager","./UIManager":"UIManager","./WeaponManager":"WeaponManager","./ZombieManager":"ZombieManager"}],GameScheduler:[function(t,e,o){"use strict";cc._RF.push(e,"88af4t6mRZOZ7C2HSXLz7DC","GameScheduler");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,c=i.ccclass,s=(i.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._zombieSpawnCallback=void 0,e._sunSpawnCallback=void 0,e._gameManager=void 0,e}return a(e,t),e.prototype.init=function(t){this._gameManager=t},e.prototype.scheduleSpawningSun=function(t,e){this._sunSpawnCallback=t,this._sunSpawnCallback&&this.schedule(this._sunSpawnCallback,e)},e.prototype.scheduleSpawningZombie=function(t,e){this._zombieSpawnCallback=t,this._zombieSpawnCallback&&this.schedule(this._zombieSpawnCallback,e)},e.prototype.stopSpawningSun=function(){this.unschedule(this._sunSpawnCallback)},e.prototype.stopSpawningZombie=function(){this.unschedule(this._zombieSpawnCallback)},e.prototype.stopAll=function(){this.stopSpawningSun(),this.stopSpawningZombie()},r([c],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],GameSetting:[function(t,e,o){"use strict";cc._RF.push(e,"f1f98MMbFtHLJRsBs/93i4u","GameSetting"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameSettings=void 0,function(t){t.getZombieSpawnX=function(){return cc.winSize.width/2-100},t.getZombieEndX=function(){return-1*cc.winSize.width/2+100},t.getBulletEndX=function(){return cc.winSize.width/2-50},t.UNIT_SUN_VALUE=25}(o.GameSettings||(o.GameSettings={})),cc._RF.pop()},{}],GridManager:[function(t,e,o){"use strict";cc._RF.push(e,"d50944CBGtFh4qmpBMKjAOn","GridManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this._gridData=[],this._gridWidth=0,this._gridHeight=0,this._startX=0,this._startY=0,this._rows=0,this._cols=0,this._gameManager=void 0}return t.prototype.init=function(t,e,o,n,a,r,i){this._gridWidth=t,this._gridHeight=e,this._startX=o,this._startY=n,this._rows=a,this._cols=r,this._gameManager=i,this._loadGridSystem()},t.prototype.endGame=function(){this._loadGridSystem()},t.prototype._loadGridSystem=function(){for(var t=0;t<this._rows;t++){this._gridData[t]=[];for(var e=0;e<this._cols;e++)this._gridData[t][e]=void 0}},t.prototype.worldPosToGrid=function(t){var e=Math.floor((t.x-this._startX)/this._gridWidth),o=Math.floor((this._startY-t.y)/this._gridHeight);return o>=0&&o<this._rows&&e>=0&&e<this._cols?{row:o,col:e}:null},t.prototype.gridToWorldPos=function(t,e){var o=this._startX+e*this._gridWidth+this._gridWidth/2,n=this._startY-t*this._gridHeight-this._gridHeight/2;return cc.v2(o,n)},t.prototype.isOccupied=function(t,e){return void 0===this._gridData[t][e]},t.prototype.getNodeOnGrid=function(t,e){return this._gridData[t][e]},t.prototype.plantOnGrid=function(t,e,o){this.isOccupied(t,e)&&(this._gridData[t][e]=o)},t.prototype.unplantFromGrid=function(t,e){var o=this._gridData[t][e];o&&(cc.Tween.stopAllByTarget(o),o.destroy(),this._gridData[t][e]=void 0)},t.prototype.getRandomWorldPosY=function(){var t=Math.floor(Math.random()*this._rows);return this._startY-t*this._gridHeight-this._gridHeight/2},t.prototype.getRandomWorldPos=function(){var t=this._cols*this._gridWidth,e=this._rows*this._gridHeight,o=this._startX,n=this._startX+t,a=this._startY,r=this._startY-e,i=Math.random()*(n-o)+o,c=Math.random()*(a-r)+r;return cc.v2(i,c)},t}();o.default=n,cc._RF.pop()},{}],IManager:[function(t,e,o){"use strict";cc._RF.push(e,"edadd80lWxDkKK8Zm9HnYTh","IManager"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],Main:[function(t,e,o){"use strict";cc._RF.push(e,"dcdb1MkW2xC+phu29DfLcKB","Main");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Managers/GameManager"),c=cc._decorator,s=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.zombieLayer=void 0,e.plantLayer=void 0,e.shovelLayer=void 0,e.dragLayer=void 0,e.sunLayer=void 0,e.scheduleLayer=void 0,e.touchEventLayer=void 0,e.weaponLayer=void 0,e.plantPrefabs=[],e.plantCardPrefabs=[],e.sunPrefab=void 0,e.weaponPrefabs=[],e.zombiePrefabs=[],e.gridWidth=165.7,e.gridHeight=144.17,e.startX=-720,e.startY=400,e.rows=6,e.cols=7,e.shovel=void 0,e.playButton=void 0,e.sunLabel=void 0,e.sunIcon=void 0,e.plantCardContainer=void 0,e.zombiesWonLabel=void 0,e}return a(e,t),e.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0,i.default.getInstance().init(this.zombieLayer,this.plantLayer,this.shovelLayer,this.dragLayer,this.sunLayer,this.scheduleLayer,this.touchEventLayer,this.weaponLayer,this.plantPrefabs,this.plantCardPrefabs,this.sunPrefab,this.weaponPrefabs,this.zombiePrefabs,this.gridWidth,this.gridHeight,this.startX,this.startY,this.rows,this.cols,this.shovel,this.playButton,this.sunLabel,this.sunIcon,this.plantCardContainer,this.zombiesWonLabel)},e.prototype.playGame=function(){i.default.getInstance().playGame()},e.prototype.update=function(t){i.default.getInstance().update(t)},r([p(cc.Node)],e.prototype,"zombieLayer",void 0),r([p(cc.Node)],e.prototype,"plantLayer",void 0),r([p(cc.Node)],e.prototype,"shovelLayer",void 0),r([p(cc.Node)],e.prototype,"dragLayer",void 0),r([p(cc.Node)],e.prototype,"sunLayer",void 0),r([p(cc.Node)],e.prototype,"scheduleLayer",void 0),r([p(cc.Node)],e.prototype,"touchEventLayer",void 0),r([p(cc.Node)],e.prototype,"weaponLayer",void 0),r([p([cc.Prefab])],e.prototype,"plantPrefabs",void 0),r([p([cc.Prefab])],e.prototype,"plantCardPrefabs",void 0),r([p(cc.Prefab)],e.prototype,"sunPrefab",void 0),r([p([cc.Prefab])],e.prototype,"weaponPrefabs",void 0),r([p([cc.Prefab])],e.prototype,"zombiePrefabs",void 0),r([p],e.prototype,"gridWidth",void 0),r([p],e.prototype,"gridHeight",void 0),r([p],e.prototype,"startX",void 0),r([p],e.prototype,"startY",void 0),r([p],e.prototype,"rows",void 0),r([p],e.prototype,"cols",void 0),r([p(cc.Node)],e.prototype,"shovel",void 0),r([p(cc.Node)],e.prototype,"playButton",void 0),r([p(cc.Label)],e.prototype,"sunLabel",void 0),r([p(cc.Node)],e.prototype,"sunIcon",void 0),r([p(cc.Node)],e.prototype,"plantCardContainer",void 0),r([p(cc.Node)],e.prototype,"zombiesWonLabel",void 0),r([s],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Managers/GameManager":"GameManager"}],NormalZombie:[function(t,e,o){"use strict";cc._RF.push(e,"dac4d+rRtFE67JXERYOZCnw","NormalZombie");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Entity"),c=t("../../Managers/ZombieManager"),s=t("../../Settings/GameSetting"),p=cc._decorator,u=p.ccclass,l=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.walkSpeed=20,e._currentState=void 0,e._currentAnimation=void 0,e}return a(e,t),e.prototype.start=function(){this._initMotion(),this.playWalkingMotion()},e.prototype.checkReachHouse=function(){return this.node.x==s.GameSettings.getZombieEndX()},e.prototype._initMotion=function(){this._currentState=c.ZombieState.Idle},e.prototype.playWalkingMotion=function(){if(this._currentState!==c.ZombieState.Walking){this.stopAnimation();var t=cc.tween(this.node).by(1/this.walkSpeed,{x:-40}).repeatForever().start();this._currentAnimation=t,this._currentState=c.ZombieState.Walking}},e.prototype.playAttackMotion=function(){if(this._currentState!==c.ZombieState.Attacking){this.stopAnimation();var t=cc.tween(this.node).repeatForever(cc.tween().by(.5,{angle:-360})).start();this._currentAnimation=t,this._currentState=c.ZombieState.Attacking}},e.prototype.stopAnimation=function(){this._currentAnimation&&(this._currentAnimation.stop(),this._currentAnimation=void 0,this.node.angle=0,this._currentState=c.ZombieState.Idle)},r([l],e.prototype,"walkSpeed",void 0),r([u],e)}(i.default);o.default=h,cc._RF.pop()},{"../../Managers/ZombieManager":"ZombieManager","../../Settings/GameSetting":"GameSetting","../Entity":"Entity"}],PeaShooter:[function(t,e,o){"use strict";cc._RF.push(e,"5150a3znXJH94cLPW3ORj8c","PeaShooter");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Plant"),c=cc._decorator,s=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._weaponManager=void 0,e}return a(e,t),e.prototype.setManager=function(t){this._weaponManager=t,this._weaponManager&&this.attack()},e.prototype.attack=function(){this._spawnWeapon()},e.prototype._spawnWeapon=function(){var t=this;this.schedule(function(){t._weaponManager.createWeapon(t.node.name,t.node.getPosition())},this.attackInterval)},r([s],e)}(i.default));o.default=p,cc._RF.pop()},{"./Plant":"Plant"}],Pea:[function(t,e,o){"use strict";cc._RF.push(e,"99872Y9QzdJCZEPQSBSklbv","Pea");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../Managers/ZombieManager"),c=t("../../Settings/GameSetting"),s=cc._decorator,p=s.ccclass,u=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._flySpeed=150,e._damage=20,e._targetX=c.GameSettings.getBulletEndX(),e}return a(e,t),e.prototype.start=function(){this._playFlyingHorizontalMotion()},e.prototype.onCollisionEnter=function(t){var e=t.node,o=i.ZoombieScriptMap[e.name],n=e.getComponent(o);null==n||n.takeDamage(this._damage),this.die()},e.prototype._playFlyingHorizontalMotion=function(){var t=this;if(this.node.parent){var e=this.node.x,o=this._targetX,n=o-e,a=Math.abs(n/this._flySpeed);cc.tween(this.node).to(a,{x:o},{easing:"linear"}).call(function(){t.die()}).start()}},e.prototype.die=function(){cc.Tween.stopAllByTarget(this.node),this.node.destroy()},r([p],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../../Managers/ZombieManager":"ZombieManager","../../Settings/GameSetting":"GameSetting"}],PlantCardManager:[function(t,e,o){"use strict";cc._RF.push(e,"9beddm01XhMG6OLMNGGvjGy","PlantCardManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this._gameManager=void 0,this._plantCardPrefabs=[],this._plantCardPrefabMap={}}return t.prototype.init=function(t,e){this._plantCardPrefabs=t,this._gameManager=e;for(var o=0,n=t;o<n.length;o++){var a=n[o],r=a.name;this._plantCardPrefabMap[r]=a}},t.prototype.playGame=function(){for(var t=0,e=this._plantCardPrefabs;t<e.length;t++){var o=e[t],n=cc.instantiate(o);n.name=o.name,this._gameManager.getUiManager().addPlantCard(n)}},t.prototype.getPlantPrefabByName=function(t){return this._plantCardPrefabMap[t]||null},t}();o.default=n,cc._RF.pop()},{}],PlantCard:[function(t,e,o){"use strict";cc._RF.push(e,"2cf20q4FBVDXLZSnavC6qD0","PlantCard");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,c=i.ccclass,s=i.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sunCost=50,e.resetTime=5,e}return a(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},r([s],e.prototype,"sunCost",void 0),r([s],e.prototype,"resetTime",void 0),r([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],PlantManager:[function(t,e,o){"use strict";cc._RF.push(e,"92089kdJxRNEp2NEQW0R+NU","PlantManager");var n=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,i=(a.property,{sun_flower:"SunFlower",pea_shooter:"PeaShooter"}),c=function(){function t(){this._gameManager=void 0,this._plantLayer=void 0,this._plantPrefabs=[],this._plantPrefabMap={}}return t.prototype.init=function(t,e,o){this._plantLayer=t,this._plantPrefabs=e,this._gameManager=o,this._loadPlants()},t.prototype._loadPlants=function(){for(var t=0,e=this._plantPrefabs;t<e.length;t++){var o=e[t],n=o.name;this._plantPrefabMap[n]=o}},t.prototype.endGame=function(){this._plantLayer.children.forEach(function(t){var e=i[t.name],o=t.getComponent(e);o&&o.die()})},t.prototype._getWeaponManagerForPlant=function(t){switch(t){case"sun_flower":return this._gameManager.getSunManager();default:return this._gameManager.getWeaponManager()}},t.prototype.getPlantPrefabByName=function(t){return this._plantPrefabMap[t]||null},t.prototype._convertNamePlantCardToPlant=function(t){return t.replace("card_","")},t.prototype.handleAttack=function(t,e,o){var n=i[t.name];!t.getComponent(n).takeDamage(o)&&this._gameManager.getGridManager().unplantFromGrid(e.row,e.col)},t.prototype.plantOnLayer=function(t,e){var o=this._convertNamePlantCardToPlant(e.name),n=this.getPlantPrefabByName(o);if(n){var a=this._gameManager.getGridManager();if(this._gameManager.getSunManager(),a.isOccupied(t.row,t.col)){var r=cc.instantiate(n),c=a.gridToWorldPos(t.row,t.col);this._plantLayer.addChild(r),r.setPosition(c),a.plantOnGrid(t.row,t.col,r);var s=this._getWeaponManagerForPlant(o),p=i[o];s&&p&&r.getComponent(p).setManager(s)}}},n([r],t)}();o.default=c,cc._RF.pop()},{}],Plant:[function(t,e,o){"use strict";cc._RF.push(e,"83780bzdeVFQJV4YeeG5MHg","Plant");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t(".././Entity"),c=cc._decorator,s=c.ccclass,p=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),r([s],e)}(i.default));o.default=p,cc._RF.pop()},{".././Entity":"Entity"}],ShovelManager:[function(t,e,o){"use strict";cc._RF.push(e,"0891dwiFkJAaoLz24Cvoujy","ShovelManager");var n=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,i=(a.property,function(){function t(){this._shovelLayer=void 0,this._gameManager=void 0,this._isShovelMode=!1,this._shovelIconClone=void 0}return t.prototype.init=function(t,e){this._shovelLayer=t,this._gameManager=e},t.prototype.endGame=function(){this._shovelIconClone&&(cc.Tween.stopAllByTarget(this._shovelIconClone),this._shovelIconClone.destroy(),this._shovelIconClone=void 0),this._exitShovelMode()},t.prototype._shovelMotion=function(){cc.tween(this._shovelIconClone).to(.2,{angle:-20}).to(.1,{angle:0}).start()},t.prototype.toggleShovelMode=function(){this._isShovelMode?this._exitShovelMode():this._enterShovelMode()},t.prototype.isInShovelMode=function(){return this._isShovelMode},t.prototype._enterShovelMode=function(){this._isShovelMode=!0,this._createShovelClone(),this._gameManager.getUiManager().setShovelOpacity(128)},t.prototype._exitShovelMode=function(){this._isShovelMode=!1,this._gameManager.getUiManager().setShovelOpacity(255),this._destroyShovelClone()},t.prototype._createShovelClone=function(){this._shovelIconClone||(this._shovelIconClone=cc.instantiate(this._gameManager.getUiManager().getShovelButton()),this._shovelLayer.addChild(this._shovelIconClone))},t.prototype._destroyShovelClone=function(){this._shovelIconClone&&(this._shovelIconClone.destroy(),this._shovelIconClone=void 0)},t.prototype.onGlobalTouchMove=function(t){if(this._isShovelMode){var e=this._shovelLayer.convertToNodeSpaceAR(t);this._shovelIconClone.setPosition(e)}},t.prototype.onGlobalTouchEnd=function(t){if(this._isShovelMode){this._shovelMotion();var e=this._shovelLayer.convertToNodeSpaceAR(t),o=this._gameManager.getGridManager().worldPosToGrid(e);o&&!this._gameManager.getGridManager().isOccupied(o.row,o.col)&&this._gameManager.getGridManager().unplantFromGrid(o.row,o.col)}},n([r],t)}());o.default=i,cc._RF.pop()},{}],SunFlower:[function(t,e,o){"use strict";cc._RF.push(e,"8f58efEoNNOLLEjhAph9dy/","SunFlower");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Plant"),c=cc._decorator,s=c.ccclass,p=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.setManager=function(t){this._sunManager=t,this._sunManager&&this.attack()},e.prototype.attack=function(){var t=this;this.schedule(function(){t._sunManager.createJumpingSun(t.node.getPosition())},this.attackInterval)},r([s],e)}(i.default));o.default=p,cc._RF.pop()},{"./Plant":"Plant"}],SunManager:[function(t,e,o){"use strict";cc._RF.push(e,"d68445D495D3IrifiilJYvI","SunManager");var n=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Characters/Sun"),r=t("../Settings/GameSetting"),i=cc._decorator,c=i.ccclass,s=(i.property,function(){function t(){this._unitSunValue=r.GameSettings.UNIT_SUN_VALUE,this._sunLayer=void 0,this._sunValue=void 0,this._gameManager=void 0,this._sunPrefab=void 0,this._sunIconPos=void 0}return t.prototype.init=function(t,e,o){this._sunLayer=t,this._sunPrefab=e,this._gameManager=o,this._sunValue=0,this._setSunIconPos()},t.prototype.playGame=function(){this._startSpawningSun()},t.prototype.endGame=function(){this._sunLayer.children.forEach(function(t){var e=t.getComponent("Sun");e&&e.die()}),this._sunValue=0},t.prototype.onGlobalTouchStart=function(t){for(var e=0,o=this._sunLayer.children;e<o.length;e++){var n=o[e];if(n.getBoundingBoxToWorld().contains(t))return this._onCollectSun(n),!0}return!1},t.prototype.addSunValue=function(t){void 0===t&&(t=this._unitSunValue),this._sunValue+=t},t.prototype.useSunValue=function(t){return this._sunValue>=t&&(this._sunValue-=t,this._gameManager.getUiManager().updateSunLabel(this._sunValue),!0)},t.prototype.getTotalSunValue=function(){return this._sunValue},t.prototype._getRandomSunPosition=function(){return this._gameManager.getGridManager().getRandomWorldPos()},t.prototype._createRandomFallingSun=function(){var t=this._createSingleSun(),e=this._getRandomSunPosition(),o=cc.winSize.height/2+100;this._sunLayer.addChild(t),t.setPosition(cc.v2(e.x,o)),t.getComponent(a.default).playFallMotion(e)},t.prototype.createJumpingSun=function(t){var e=this._createSingleSun();this._sunLayer.addChild(e),e.setPosition(t),e.getComponent(a.default).playRandomJumpMotion(t)},t.prototype._createSingleSun=function(){return cc.instantiate(this._sunPrefab)},t.prototype._setSunIconPos=function(){var t=this._gameManager.getUiManager().sunIcon.convertToWorldSpaceAR(cc.v2(0,0));this._sunIconPos=this._sunLayer.convertToNodeSpaceAR(t)},t.prototype._onCollectSun=function(t){t.getComponent(a.default).playCollectedMotion(this._sunIconPos,this._onCollectSunEvents.bind(this))},t.prototype._onCollectSunEvents=function(){this.addSunValue(this._unitSunValue),this._gameManager.getUiManager().updateSunLabel(this._sunValue)},t.prototype._startSpawningSun=function(t){void 0===t&&(t=5),this._gameManager.getGameScheduler().scheduleSpawningSun(this._createRandomFallingSun.bind(this),t)},n([c],t)}());o.default=s,cc._RF.pop()},{"../Characters/Sun":"Sun","../Settings/GameSetting":"GameSetting"}],Sun:[function(t,e,o){"use strict";cc._RF.push(e,"d9771G1iiBJ4beQ7P2PTOcQ","Sun");var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Entity"),c=cc._decorator,s=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lifeTime=5,e}return a(e,t),e.prototype.playFallMotion=function(t){var e=this;cc.tween(this.node).to(3,{y:t.y},{easing:"linear"}).call(function(){e._playFadeMotion()}).start()},e.prototype.playCollectedMotion=function(t,e){var o=this;this._onCollectedCB=e,this._onCollectedCB&&cc.tween(this.node).to(.5,{position:cc.v3(t.x,t.y,0)},{easing:"quadOut"}).call(function(){o.die(),o._onCollectedCB()}).start()},e.prototype._playFadeMotion=function(){var t=this;cc.tween(this.node).to(this.lifeTime,{opacity:.5*this.node.opacity}).call(function(){t.die()}).start()},e.prototype.playRandomJumpMotion=function(t){var e=this,o=Math.random()<.5?-1:1,n=cc.v3(t.x+150*o,t.y,0);cc.tween(this.node).to(.8,{position:n},{progress:function(t,e,o,n){var a=t.x+(e.x-t.x)*n,r=600*n*(1-n),i=t.y+(e.y-t.y)*n+r;return cc.v2(a,i)}}).call(function(){e._playFadeMotion()}).start()},e.prototype.die=function(){cc.Tween.stopAllByTarget(this.node),this.node.destroy()},r([p],e.prototype,"lifeTime",void 0),r([s],e)}(i.default);o.default=u,cc._RF.pop()},{"./Entity":"Entity"}],TouchEventManager:[function(t,e,o){"use strict";cc._RF.push(e,"4af8fenn89DubHEc2K5i8WL","TouchEventManager");var n=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,i=(a.property,function(){function t(){this._activeTouchHandler=void 0}return t.prototype.init=function(t,e){this._gameManager=e,this._touchEventLayer=t},t.prototype.playGame=function(){this._touchEventLayer.on(cc.Node.EventType.TOUCH_START,this._onTouchStart,this),this._touchEventLayer.on(cc.Node.EventType.MOUSE_MOVE,this._onTouchMove,this),this._touchEventLayer.on(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this)},t.prototype.endGame=function(){this._touchEventLayer.off(cc.Node.EventType.TOUCH_START,this._onTouchStart,this),this._touchEventLayer.off(cc.Node.EventType.MOUSE_MOVE,this._onTouchMove,this),this._touchEventLayer.off(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this),this._activeTouchHandler=void 0},t.prototype._onTouchStart=function(t){var e=t.getLocation();if("shovel"!==this._activeTouchHandler){if(this._gameManager.getSunManager().onGlobalTouchStart(e))return void(this._activeTouchHandler="sun");if(this._gameManager.getDragManager().onGlobalTouchStart(e))return void(this._activeTouchHandler="drag")}this._gameManager.getUiManager().onGlobalTouchStart(e)?"shovel"===this._activeTouchHandler?this._activeTouchHandler=void 0:this._activeTouchHandler="shovel":"shovel"===this._activeTouchHandler&&this._gameManager.getShovelManager().onGlobalTouchEnd(e)},t.prototype._onTouchMove=function(t){var e=t.getLocation();switch(this._activeTouchHandler){case"drag":this._gameManager.getDragManager().onGlobalTouchMove(e);break;case"shovel":this._gameManager.getShovelManager().onGlobalTouchMove(e)}},t.prototype._onTouchEnd=function(t){var e=t.getLocation();switch(this._activeTouchHandler){case"drag":this._gameManager.getDragManager().onGlobalTouchEnd(e),this._activeTouchHandler=void 0}},n([r],t)}());o.default=i,cc._RF.pop()},{}],UIManager:[function(t,e,o){"use strict";cc._RF.push(e,"45732AyhWlNSJ1Hq6iQ2qw+","UIManager");var n=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,i=(a.property,function(){function t(){this.shovelButton=void 0,this.playButton=void 0,this.sunLabel=void 0,this.sunIcon=void 0,this.plantCardContainer=void 0,this.zombiesWonLabel=void 0,this._clickShovelCallback=void 0,this._gameManager=void 0}return t.prototype.init=function(t,e,o,n,a,r,i,c){this.shovelButton=t,this.playButton=e,this.sunLabel=o,this.sunIcon=n,this.plantCardContainer=a,this.zombiesWonLabel=r,this._gameManager=i,this._clickShovelCallback=c,this.playButton.active=!0},t.prototype.playGame=function(){this.playButton.active=!1,this.shovelButton.active=!0,this.plantCardContainer.active=!0,this.sunLabel.node.active=!0,this.sunIcon.active=!0,this.zombiesWonLabel.active=!1},t.prototype.endGame=function(){this.shovelButton.active=!1,this.plantCardContainer.active=!1,this.sunLabel.node.active=!1,this.sunIcon.active=!1,this.zombiesWonLabel.active=!0,this.clearPlantCard(),this.updateSunLabel(0)},t.prototype.onGlobalTouchStart=function(t){return!!this.shovelButton.getBoundingBoxToWorld().contains(t)&&(this._gameManager.getShovelManager().toggleShovelMode(),!0)},t.prototype.setShovelOpacity=function(t){this.shovelButton.opacity=t},t.prototype.getShovelButton=function(){return this.shovelButton},t.prototype.updateSunLabel=function(t){this.sunLabel.string=t.toString()},t.prototype.addPlantCard=function(t){this.plantCardContainer.addChild(t)},t.prototype.clearPlantCard=function(){this.plantCardContainer.removeAllChildren()},n([r],t)}());o.default=i,cc._RF.pop()},{}],WeaponManager:[function(t,e,o){"use strict";cc._RF.push(e,"e640az4ldxG+5Rpl+rPfPO8","WeaponManager");var n=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,i=(a.property,{pea_shooter:"pea"}),c={pea:"Pea"},s=function(){function t(){this._gameManager=void 0,this._weaponLayer=void 0,this._weaponPrefabs=[],this._weaponPrefabMap={}}return t.prototype.init=function(t,e,o){this._gameManager=o,this._weaponLayer=t,this._weaponPrefabs=e;for(var n=0,a=this._weaponPrefabs;n<a.length;n++){var r=a[n],i=r.name;this._weaponPrefabMap[i]=r}},t.prototype.endGame=function(){this._weaponLayer.children.forEach(function(t){var e=c[t.name],o=t.getComponent(e);o&&o.die()})},t.prototype.getWeaponPrefabByName=function(t){return this._weaponPrefabMap[t]||null},t.prototype.createWeapon=function(t,e){var o=i[t];if(o){e.x+=30,e.y+=20;var n=this._createSingleWeaponNode(o);n&&(this._weaponLayer.addChild(n),n.setPosition(e))}},t.prototype._createSingleWeaponNode=function(t){var e=this.getWeaponPrefabByName(t);return e?cc.instantiate(e):null},n([r],t)}();o.default=s,cc._RF.pop()},{}],ZombieManager:[function(t,e,o){"use strict";cc._RF.push(e,"02bf4530r5DAZPixx2oyQHI","ZombieManager");var n=this&&this.__decorate||function(t,e,o,n){var a,r=arguments.length,i=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(i=(r<3?a(i):r>3?a(e,o,i):a(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0}),o.ZoombieScriptMap=o.ZombieState=void 0;var a=t("../Settings/GameSetting"),r=cc._decorator,i=r.ccclass;r.property,function(t){t[t.Idle=0]="Idle",t[t.Walking=1]="Walking",t[t.Attacking=2]="Attacking",t[t.Dead=3]="Dead"}(o.ZombieState||(o.ZombieState={})),o.ZoombieScriptMap={normal_zombie:"NormalZombie"};var c=function(){function t(){this._zombieLayer=void 0,this._zombiePrefabs=void 0,this._gameManager=void 0,this._zombiePrefabMap={}}return t.prototype.init=function(t,e,o){this._zombieLayer=t,this._zombiePrefabs=e,this._gameManager=o;for(var n=0,a=this._zombiePrefabs;n<a.length;n++){var r=a[n],i=r.name;this._zombiePrefabMap[i]=r}},t.prototype.playGame=function(){this._startSpawningZombie()},t.prototype.endGame=function(){this._zombieLayer.children.forEach(function(t){var e=t.getComponent("NormalZombie");e&&e.die()})},t.prototype.update=function(){this._zombieLayer.children;for(var t=0,e=this._zombieLayer.children;t<e.length;t++){var n=e[t],a=o.ZoombieScriptMap[n.name],r=n.getComponent(a);if(r.checkReachHouse()){r.die(),this._gameManager.endGame();break}this._checkAttack(n)}},t.prototype._checkAttack=function(t){var e=this._gameManager.getGridManager(),n=this._gameManager.getPlantManager(),a=o.ZoombieScriptMap[t.name],r=t.getComponent(a),i=t.getPosition(),c=e.worldPosToGrid(i);if(c){var s=e.getNodeOnGrid(c.row,c.col);if(s){var p=r.getDamage();r.playAttackMotion(),n.handleAttack(s,c,p)}else r.playWalkingMotion()}},t.prototype.getZombiePrefabByName=function(t){return this._zombiePrefabMap[t]||null},t.prototype._createSingleZombieNode=function(t){var e=this.getZombiePrefabByName(t);return e?cc.instantiate(e):null},t.prototype._getRandomZombiePosY=function(){return this._gameManager.getGridManager().getRandomWorldPosY()+30},t.prototype._createRandomZombie=function(){var t=this._createSingleZombieNode("normal_zombie"),e=this._getRandomZombiePosY(),o=a.GameSettings.getZombieSpawnX();this._zombieLayer.addChild(t),t.setPosition(cc.v2(o,e))},t.prototype._startSpawningZombie=function(t){void 0===t&&(t=10),this._gameManager.getGameScheduler().scheduleSpawningZombie(this._createRandomZombie.bind(this),t)},n([i],t)}();o.default=c,cc._RF.pop()},{"../Settings/GameSetting":"GameSetting"}]},{},["Entity","PeaShooter","Plant","SunFlower","PlantCard","Sun","Pea","NormalZombie","GameScheduler","TouchEventManager","Main","DragManager","GameManager","GridManager","IManager","PlantCardManager","PlantManager","ShovelManager","SunManager","UIManager","WeaponManager","ZombieManager","GameSetting"]);